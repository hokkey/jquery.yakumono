/**!
  @license
  jQuery.yakumono (0.3.0) github.com/hokkey/jquery.yakumono
  (C) 2017 Yuma Hori.
  MIT license: en.wikipedia.org/wiki/MIT_License
*/
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};(function(a){"object"===("undefined"==typeof module?"undefined":_typeof(module))&&"object"===_typeof(module.exports)?module.exports=a(require("jquery"),window,document):a(jQuery,window,document)})(function(a,b){var f={yakumono:function yakumono(g,h){if(0===g.length)return g;if("function"!==a.type(a().blast))return console.error("jQuery.yakumono: Blast.js\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3002"),g;var i=a.extend({},a.fn.yakumono.defaults,h);return i.safariMode=f.checkSafari(i),g.each(function(){f.init(a(this),i)}),f.watchResize(g,i),g},checkSafari:function checkSafari(g){return!(!0!==g.polyfillSafari)&&-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&-1===navigator.userAgent.indexOf("Edge")},init:function init(g,h){h.safariMode&&g.addClass(h.className.safari),f.replaceDash(g,h),f.makeGyomatsuYakumonoHankaku(g,h),f.makeJisage(g,h),f.makeTategumi(g,h),f.makeBetagumi(g,h),f.makeTsumegumi(g,h),f.blast(g,h);var i=f.detectYakumono(g,h);return f.detectYakumonoContext(i,h),f.detectGyotouGyoumatsu(i,h),i},replaceDash:function replaceDash(g,h){h.replaceDash&&g.html(g.html().replace("\u2015\u2015","\u2500\u2500"))},makeTsumegumi:function makeTsumegumi(g,h){!0!==h.isTsumegumi||g.addClass(h.className.tsumegumi)},makeJisage:function makeJisage(g,h){!0!==h.useJisage||g.addClass(h.className.jisage)},makeTategumi:function makeTategumi(g,h){!0!==h.isTategumi||g.addClass(h.className.tategumi)},makeGyomatsuYakumonoHankaku:function makeGyomatsuYakumonoHankaku(g,h){!0!==h.isGyomatsuYakumonoHankaku||g.addClass(h.className.gyomatsuYakumonoHankaku)},makeBetagumi:function makeBetagumi(g,h){if(!(!0!==h.isBetagumi||h.isTsumegumi)){if(h.betagumiCenter&&g.addClass(h.className.betagumiCenter),!h.isTategumi){g.addClass(h.className.betagumi).width("");var i=parseInt(g.css("font-size"),10),j=g.width(),k=Math.floor(j/i);return void g.width(k+"em")}if(h.isTategumi){g.addClass(h.className.betagumi).height("");var i=parseInt(g.css("font-size"),10),j=g.height(),k=Math.floor(j/i);g.height(k+"em")}}},blast:function blast(g,h){return g.blast({delimiter:"character",tag:"span",customClass:h.className.char})},detectYakumono:function detectYakumono(g,h){var i=g.find("."+h.className.char);return i.each(function(){f.addYakumonoClass(a(this),h)}),i},addYakumonoClass:function addYakumonoClass(g,h){var i=g.text();for(var j in h.dict)if(null!==i.match(h.dict[j]))return void g.addClass(h.className.yakumono+" "+h.className.yakumono+h.className.separator+j)},detectYakumonoContext:function detectYakumonoContext(g,h){var i=null;g.each(function(){i=f.setYakumonoContextClass(i,a(this),h)})},setYakumonoContextClass:function setYakumonoContextClass(g,h,i){if(null===g||!g.hasClass(""+i.className.yakumono))return h;for(var j in i.dict)h.hasClass(""+i.className.yakumono+i.className.separator+j)&&g.addClass(""+i.className.yakumono+i.className.separator+"before"+i.className.separator+j),g.hasClass(""+i.className.yakumono+i.className.separator+j)&&h.addClass(""+i.className.yakumono+i.className.separator+"after"+i.className.separator+j);return h},detectGyotouGyoumatsu:function detectGyotouGyoumatsu(g,h){var i=null,j=null,k,l=function getOffset(m){return h.isTategumi?m[0].offsetLeft:m[0].offsetTop};g.css("letter-spacing","").removeClass(h.className.startOfLine+" "+h.className.endOfLine+" "+h.className.oidashi+" "+h.className.oidashiSmall).each(function(){var m=a(this);if(j=l(m),null==i)return m.addClass(h.className.startOfLine),i=j,void(k=m);if(j>i){k.addClass(h.className.endOfLine);var o=l(m);o===j&&(m.addClass(h.className.startOfLine),l(m)!==j&&k.addClass(h.className.oidashiSmall)),o!==j&&((!h.useLetterSpacingAdjustment||h.isTategumi)&&k.addClass(h.className.oidashi),h.useLetterSpacingAdjustment&&f.adjustLetterSpacing(k,h))}i=j,k=m})},floatFormat:function floatFormat(g,h){var i=Math.pow(10,h);return Math.floor(g*i)/i},adjustLetterSpacing:function adjustLetterSpacing(g,h){if(!h.isTategumi){var i=f.getCharsOfLine(g,h),j=f.floatFormat(0.965/i.length,5);i.forEach(function(k){k.css("letter-spacing",j+"em")})}},getCharsOfLine:function getCharsOfLine(g,h){for(var m,i=h.className.startOfLine,j=!1,k=[],l=g;!1==j;)m=l.prev(),0===m.length&&(j=!0),k.push(m),m.hasClass(i)&&(j=!0),l=m;return k},update:function update(g,h){g.each(function(){var i=a(this),j=i.find("."+h.className.char);f.makeBetagumi(i,h),f.detectGyotouGyoumatsu(j,h)})},watchResize:function watchResize(g,h){if(h.watchResize){var i=null;a(b).on("resize",function(){i=f.checkTimer(i,h.watchDelay,function(){f.update(g,h)})})}},checkTimer:function checkTimer(g,h,i){return null!==g&&clearTimeout(g),setTimeout(function(){i()},h)}};Object.freeze(f),a.fn.yakumono=function(g){return f.yakumono(this,g)},a.fn.yakumono.defaults={dict:{hajimekakko:/（|〔|「|『|［|【|〈|《|‘|“/,owarikakko:/）|〕|」|』|］|】|〉|》|’|”/,nakaten:/・|：|；/,kuten:/。|．/,touten:/、|，/,kugiri:/！|？/,hyphen:/‐|〜/,bunrikinshi:/…|‥|—/},className:{separator:"--",betagumi:"is-betagumi",betagumiCenter:"is-betagumi-center",tsumegumi:"is-tsumegumi",tategumi:"is-tategumi",jisage:"is-jisage",gyomatsuYakumonoHankaku:"is-gyomatsu-yakumono-hankaku",char:"js-char",yakumono:"js-char-yakumono",startOfLine:"is-start-of-line",endOfLine:"is-end-of-line",oidashi:"is-oidashi",oidashiSmall:"is-oidashi-small",safari:"is-safari"},polyfillSafari:!0,safariMode:!1,replaceDash:!1,watchResize:!0,watchDelay:300,useLetterSpacingAdjustment:!0,isGyomatsuYakumonoHankaku:!0,isBetagumi:!0,betagumiCenter:!1,isTsumegumi:!1,useJisage:!1,isTategumi:!1}});
