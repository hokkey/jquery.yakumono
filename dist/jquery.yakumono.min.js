/*! jQuery.yakumono (0.2.0) github.com/hokkey/jquery.yakumono (C) 2017 Yuma Hori. MIT @license: en.wikipedia.org/wiki/MIT_License */
"use strict";function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};!function(a){"object"===("undefined"==typeof module?"undefined":_typeof(module))&&"object"===_typeof(module.exports)?module.exports=a(require("jquery"),window,document):a(jQuery,window,document)}(function(a,b,c,d){var e,f=(e={yakumono:function(c,d){if(0===c.length)return c;if("function"!==a.type(a().blast))return console.error("jQuery.yakumono: Blast.jsが見つかりません。"),c;var e=a.extend({},a.fn.yakumono.defaults,d);return c.each(function(){f.init(a(this),e)}),f.watchResize(c,e),c},init:function(b,c){f.replaceDash(b,c),f.makeJisage(b,c),f.makeTategumi(b,c),f.makeBetagumi(b,c),f.makeTsumegumi(b,c),f.blast(b,c);var d=f.detectYakumono(b,c);return f.detectYakumonoContext(d,c),f.detectGyotouGyomatsu(d,c),d},replaceDash:function(b,c){c.replaceDash&&b.html(b.html().replace("――","──"))},makeTsumegumi:function(b,c){c.isTsumegumi===!0&&b.addClass(c.className.tsumegumi)},makeJisage:function(b,c){c.useJisage===!0&&b.addClass(c.className.jisage)},makeTategumi:function(b,c){c.isTategumi===!0&&b.addClass(c.className.tategumi)}},_defineProperty(e,"makeTategumi",function(b,c){c.isTategumi===!0&&b.addClass(c.className.tategumi)}),_defineProperty(e,"makeBetagumi",function(b,c){if(c.isBetagumi===!0){if(c.betagumiCenter&&b.addClass(c.className.betagumiCenter),!c.isTategumi){b.addClass(c.className.betagumi).width("");var d=parseInt(b.css("font-size"),10);console.log(d);var e=b.width(),f=Math.floor(e/d);return void b.width(f+"em")}if(c.isTategumi){b.addClass(c.className.betagumi).height("");var g=parseInt(b.css("font-size"),10);console.log(g);var h=b.height(),i=Math.floor(h/g);b.height(i+"em")}}}),_defineProperty(e,"blast",function(b,c){return b.blast({delimiter:"character",tag:"span",customClass:c.className.char})}),_defineProperty(e,"detectYakumono",function(c,d){var e=c.find("."+d.className.char);return e.each(function(){f.addYakumonoClass(a(this),d)}),e}),_defineProperty(e,"addYakumonoClass",function(b,c){var d=b.text();for(var e in c.dict)if(null!==d.match(c.dict[e]))return void b.addClass(c.className.yakumono+" "+c.className.yakumono+"--"+e)}),_defineProperty(e,"detectYakumonoContext",function(c,d){var e=null;c.each(function(){e=f.setYakumonoContextClass(e,a(this),d)})}),_defineProperty(e,"setYakumonoContextClass",function(b,c,d){if(null===b||!b.hasClass(""+d.className.yakumono))return c;for(var e in d.dict)c.hasClass(d.className.yakumono+"--"+e)&&b.addClass(d.className.yakumono+"--before--"+e),b.hasClass(d.className.yakumono+"--"+e)&&c.addClass(d.className.yakumono+"--after--"+e);return c}),_defineProperty(e,"detectGyotouGyomatsu",function(c,d){var e=null,f=null,g=void 0,h=function(b){return d.isTategumi?b[0].offsetLeft:b[0].offsetTop};c.removeClass(d.className.startOfLine+" "+d.className.endOfLine+" "+d.className.oidashi).each(function(b){var c=a(this);if(f=h(c),null===e)return c.addClass(d.className.startOfLine),e=f,void(g=c);if(f>e){g.addClass(d.className.endOfLine);var i=h(c);i===f?c.addClass(d.className.startOfLine):(g.removeClass(d.className.endOfLine),c.addClass(d.className.endOfLine))}e=f,g=c})}),_defineProperty(e,"update",function(c,d){c.each(function(){var b=a(this),c=b.find("."+d.className.char);f.makeBetagumi(b,d),f.detectGyotouGyomatsu(c,d)})}),_defineProperty(e,"watchResize",function(d,e){if(e.watchResize){var g=null;a(b).on("resize",function(){g=f.checkTimer(g,e.watchDelay,function(){f.update(d,e)})})}}),_defineProperty(e,"checkTimer",function(b,c,d){return null!==b&&clearTimeout(b),setTimeout(function(){d()},c)}),e);Object.freeze(f),a.fn.yakumono=function(a){return f.yakumono(this,a)},a.fn.yakumono.defaults={dict:{hajimekakko:/（|〔|「|『|［|【|〈|《|‘|“/,owarikakko:/）|〕|」|』|］|】|〉|》|’|”/,nakaten:/・|：|；/,kuten:/。|．/,touten:/、|，/,kugiri:/！|？/,hyphen:/‐|〜/,bunrikinshi:/…|‥|—/},className:{betagumi:"is-betagumi",betagumiCenter:"is-betagumi-center",tsumegumi:"is-tsumegumi",tategumi:"is-tategumi",jisage:"is-jisage",char:"js-char",yakumono:"js-char--yakumono",startOfLine:"is-start-of-line",endOfLine:"is-end-of-line"},replaceDash:!1,watchResize:!0,watchDelay:300,isBetagumi:!1,betagumiCenter:!1,isTsumegumi:!1,useJisage:!1,isTategumi:!1}});
