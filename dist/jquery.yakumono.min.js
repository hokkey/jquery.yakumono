/*! jquery.yakumono (0.1) github.com/hokkey/jquery.yakumono (C) 2017 Yuma Hori. MIT @license: en.wikipedia.org/wiki/MIT_License */
!function(a){"object"===("undefined"==typeof module?"undefined":_typeof(module))&&"object"===_typeof(module.exports)?module.exports=a(require("jquery"),window,document):a(jQuery,window,document)}(function(a,b,c,d){a.fn.yakumono=function(c){function e(b,c){f(b,c),b.blast({delimiter:"character",tag:"span",customClass:c.className.char});var d=b.find("."+c.className.char),e=c.dict;return d.each(function(){var b=a(this),d=b.text();for(var f in e)if(null!==d.match(e[f]))return void b.addClass(c.className.yakumono+" "+c.className.yakumono+"--"+f)}),g(d,c),h(d),d}function f(a,b){if(b.forceEmBaseWidth){a.width("");var c=parseInt(a.css("font-size"),10),d=parseInt(a.css("letter-spacing"),10),e=d/c,f=a.width(),g=f/(c+e),h=Math.floor(g)-e,i=Math.floor((f-h*c)/c);a.width(h+i+"em")}}function g(b,c){var d=void 0;b.each(function(b){var e=a(this);if(0===b)return void(d=e);if(!d.hasClass(""+c.className.yakumono))return void(d=e);for(var f in c.dict)if(e.hasClass(c.className.yakumono+"--"+f))return d.addClass(c.className.yakumono+"--before--"+f),void(d=e);d=e})}function h(b){var c=null,e=null,f=void 0;b.removeClass(d.className.startOfLine+" "+d.className.endOfLine+" "+d.className.oidashi).each(function(g){var h=a(this);if(e=h[0].offsetTop,null===c)return h.addClass(d.className.startOfLine),c=e,void(f=h);if(e>c){h.addClass(d.className.startOfLine),f.addClass(d.className.endOfLine);var i=h[0].offsetTop;i!==e&&(f.addClass(d.className.oidashi),g!==b.length&&b.eq(g+1).addClass(d.className.afterOidashi))}c=e,f=h})}function i(c,d){if(d.watchResize){var e=null;a(b).on("resize",function(){e=j(e,d.watchDelay,function(){c.each(function(){var b=a(this),c=b.find("."+d.className.char);f(b,d),h(c,d)})})})}}function j(a,b,c){return null!==a&&clearTimeout(a),setTimeout(function(){c()},b)}if(0!==this.length){var d=a.extend({dict:{hajimekakko:/（|「|『|［|【|〈|《/,owarikakko:/）|」|』|］|】|〉|》/,nakaten:/・|：|；/,kuten:/。|．/,touten:/、|，/,kantan:/！|？/},className:{char:"js-char",yakumono:"js-char--yakumono",startOfLine:"is-start-of-line",endOfLine:"is-end-of-line",oidashi:"is-oidashi",afterOidashi:"is-after-oidashi"},watchResize:!0,watchDelay:300,forceEmBaseWidth:!0},c);Object.freeze(d),this.each(function(){e(a(this),d)}),i(this,d)}}});
